#!/bin/bash

# build first with:
pushd ~/SOLA/WebAssembly/fuzzing/public-project-repo/fuzzm-project/wasm_instrumenter/
cargo build --bin canaries
popd

# instrument
cd out/
~/SOLA/WebAssembly/fuzzing/public-project-repo/fuzzm-project/wasm_instrumenter/target/debug/canaries main.wasm main.canaries.wasm --skip-print --skip-heap
chmod +x main.canaries.wasm
mv main.wasm main.orig.wasm
mv main.canaries.wasm main.wasm

./server.py
firefox localhost:8000/main.html